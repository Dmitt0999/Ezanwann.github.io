<!DOCTYPE html>
<html>
    <head>
        <title>Page Title</title>
    </head>
    <body>
    <h4>Instant AI image generation, developed by Wann</h2>
        <img id="myimg" alt="result here">
        <input type="file" id="fileInput" accept="image/*"> <br><br> <img id="imagePreview" style="max-width: 100%; display: none;"> <br><br>
        <input type="text" id="imageUrl" placeholder="Enter image URL">
    <button id="fetchImage">Fetch Image</button>
        <textarea id="prompt"></textarea>
        <button id="change">Vary</button>
    </body>
    <script>
        /*function copyToClipboard3(text) {
    navigator.clipboard.writeText(text).then(() => {
        console.log('Text copied to clipboard');
    }).catch(err => {
        console.error('Failed to copy text: ', err);
    });
}*/

onload=e=>{

function copyToClipboard(text) {
    const p = document.createElement("p");
    p.innerHTML=text;
    document.body.appendChild(p);
    
}

let uu="8ea473656564a53234363539a86d6f64656c5f6964a76b7265615f786ca670726f6d7074da019b61616161616161343030303030303061617373686873687368736a736965697268726862646a646a64687361616161616168646a646a646a646a6864626468646a65696561676761616161616161616161616161616161616161616161737373736864686568656264686568656868656161616161616161616101016161616161616161616161686568646a646a666a6a666a66687268726a6a726a726a726a726a6a726a646a726a726a6a746a666a726a646a646a6a65686576626562656a656a69736a64686468646a646a6a646a646a646a646a6a646a646a726a646a646a646a6468687268726872687268726a726a6a64696569656a736273686964756568656868656a65696569656868656a726964697269666a6a726a726a746a6b746f746b746b746b746b6a746a746a666a666a6a66666a6a666a666a6a666a666a666a666a666a6a666a666a666a646b6b646b646a6a646a646a646a68666a666a666a666a6a666a666a666a666a6a666a666a666a666a666a666a666a666a666a6a666a666a666a61616161616161612c206f626a65637420386bae67756964616e63655f7363616c6500a8737472656e67746801a5737465707305ac7374796c655f696d616765739182a464617461da072e646174613a696d6167652f706e673b6261736536342c6956424f5277304b47676f414141414e5355684555674141414f41414141446743415941414141614c5772684141414141584e535230494172733463365141414251784a52454655654637743038454a4144414d784c426d38327a655170667752316e67514d537a752f63344167515367524667346d3655774263516f45636745416f494d4d513354554341666f42414b434441454e38304151483641514b6867414244664e4d45424f67484349514341677a7854524d516f42386745416f494d4d513354554341666f42414b434441454e38304151483641514b6867414244664e4d45424f67484349514341677a7854524d516f42386745416f494d4d513354554341666f42414b434441454e38304151483641514b6867414244664e4d45424f67484349514341677a7854524d516f42386745416f494d4d513354554341666f42414b434441454e38304151483641514b6867414244664e4d45424f67484349514341677a7854524d516f42386745416f494d4d513354554341666f42414b434441454e38304151483641514b6867414244664e4d45424f67484349514341677a7854524d516f42386745416f494d4d513354554341666f42414b434441454e38304151483641514b6867414244664e4d45424f67484349514341677a7854524d516f42386745416f494d4d513354554341666f42414b434441454e38304151483641514b6867414244664e4d45424f67484349514341677a7854524d516f42386745416f494d4d513354554341666f42414b434441454e38304151483641514b6867414244664e4d45424f67484349514341677a7854524d516f42386745416f494d4d513354554341666f42414b434441454e38304151483641514b6867414244664e4d45424f67484349514341677a7854524d516f42386745416f494d4d513354554341666f42414b434441454e38304151483641514b6867414244664e4d45424f67484349514341677a7854524d516f42386745416f494d4d513354554341666f42414b434441454e38304151483641514b6867414244664e4d45424f67484349514341677a7854524d516f42386745416f494d4d513354554341666f42414b434441454e38304151483641514b6867414244664e4d45424f67484349514341677a7854524d516f42386745416f494d4d513354554341666f42414b434441454e38304151483641514b6867414244664e4d45424f67484349514341677a7854524d516f42386745416f494d4d513354554341666f42414b434441454e38304151483641514b6867414244664e4d45424f67484349514341677a7854524d516f42386745416f494d4d513354554341666f42414b434441454e38304151483641514b6867414244664e4d45424f67484349514341677a7854524d516f42386745416f494d4d513354554341666f42414b434441454e38304151483641514b6867414244664e4d45424f67484349514341677a7854524d516f42386745416f494d4d513354554341666f42414b434441454e38304151483641514b6867414244664e4d45424f67484349514341677a7854524d516f42386745416f494d4d513354554341666f42414b434441454e38304151483641514b6867414244664e4d45424f67484349514341677a7854524d516f42386745416f494d4d513354554341666f42414b434441454e38304151483641514b6867414244664e4d45424f67484349514341677a7854524d516f42386745416f494d4d513354554341666f42414b434441454e38304151483641514b6867414244664e4d45424f67484349514341677a7854524d516f42386745416f494d4d513354554341666f42414b434441454e38304151483641514b6867414244664e4d45424f67484349514341677a7854524d516f42386745416f494d4d513354554341666f42414b434441454e38304151483641514b6867414244664e4d45424f67484349514341677a7854524d516f42386745416f494d4d513354554341666f42414b434441454e38304151483641514b6867414244664e4d45424f67484349514341677a7854524d516f42386745416f494d4d513354554341666f42414b434441454e38304151483641514b6867414244664e4d45424f67484349514341677a7854524d516f42386745416f494d4d513354554341666f42414b434441454e38304151483641514b6867414244664e4d45424f67484349514341677a7854524d516f42386745416f494d4d513354554341666f42414b434441454e38304151483641514b6867414244664e4d45424f67484349514341677a7854524d516f42386745416f494d4d513354554341666f42414b434441454e38304151483641514b6867414244664e4d45424f67484349514341677a7854524d516f42386745416f494d4d513354554341666f42414b434441454e38304151483641514b6867414244664e4d45487056334d422b313961342b4141414141456c46546b5375516d4343a8737472656e677468cb3fd999999999999aa57769647468cd0400a6686569676874cd0400ae636f6d62696e655f6d6574686f64a761766572616765b0676c6f62616c5f69705f776569676874cb3fd999999999999ab6676c6f62616c5f7374796c655f69705f776569676874cb3ff4cccccccccccdaa696d6167655f73697a65cd0576ab696d6167655f6279746573c50576524946466e05000057454250565038580a000000200000001f00001f000049434350c8010000000001c800000000043000006d6e74725247422058595a2007e00001000100000000000061637370000000000000000000000000000000000000000000000000000000010000f6d6000100000000d32d0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000964657363000000f0000000247258595a00000114000000146758595a00000128000000146258595a0000013c00000014777470740000015000000014725452430000016400000028675452430000016400000028625452430000016400000028637072740000018c0000003c6d6c756300000000000000010000000c656e5553000000080000001c007300520047004258595a200000000000006fa2000038f50000039058595a2000000000000062990000b785000018da58595a2000000000000024a000000f840000b6cf58595a20000000000000f6d6000100000000d32d706172610000000000040000000266660000f2a700000d59000013d000000a5b00000000000000006d6c756300000000000000010000000c656e5553000000200000001c0047006f006f0067006c006500200049006e0063002e0020003200300031003656503820800300003011009d012a2000200001402625b00274ca0c60f604180db01fa93bc03ce03d0efd403d003ca7ff703e003f683f6dbda9ffffe08234132b3f1990377e7de0dc01d81545bfc67849ff1fdec51d27a01fd57c01be01fe03cddffc7f627fd2ffe3ff52f305f18ff8bfed3f001fc67f99ffabfee9eccdea8bf403d8d7f54cfb6ac4b28faf2cfe1cc7ccb8f0d8b94298973e000000f8cc488f334c34bb1dad95413912f63dbb8a777395638b0ccfd7fe9f8abdd17f57825c1a8e40decd91977164546a259cd0bbca50b8f9ef12f5ea2a004443375f3a12d2f443ae7538ed25ac789766310139d7011ffaec8938b7baf4e50efcf27aa794b5730b9dbdd8a0fe4667d745a3d5dac92f2105d591aa970a43ad86eb888c992aa71862e7d2f767a3a486a717ad73e6f3cc83624766de0033227782d9673ce0d892bf9fa8d373604125b286c44831f419e1eff1f54c4dcd91f34fcf6c7900569f49c99dfdbfb4358c9b079dd93cb948b4b8cbdd38ffc39be43d2b3af12c531ffa4385f9a0cbeea3b302b2700b5fc775570e79d1fc354bd30ffe74ac3c467d970cf7e939982b0e6017c166523b948ad89b495f0fe7b53374edbd0bb846fa28750300697c76dfe79e0a50a42fc26a60dec501694f168d929e7fc90d640c6dad68a9d8c85a4808d177f7d146cf49cbd20bb017abf17912145f8e285f771ee1c5aaa9700bf1541f2d45a2069c17983f524c9d32c53265e675277a8c43a2d1b2f2f1083e0a956ffc30e745c4f54b9e082dc859545a08d59de1e5ee9e4c56058527e3fcdd31dd96109f4b6b62e40267bfdb8fb5533cea2b4a747ca35df9b9e9d7cef931f5e282b19f621545b38c57005000377c4992fa876ff4baa5288c4c4ea82cdfaddaf44d476e7f85e57b0b46dac409668ede9ed9ff7c8caa552c7cb8272c0e8743a43d200e4f306e3e43ff17f7d79c3ac41b1cbaa94d94443e7f84cb7b72c1b357787ce275e91d8c5d00a770ee54a7dd8392d3732b3d743282ecc6b33f3e9838eb713391bb4a84ee910bfe90ecc336ca856628330417ad72fbf5afae8128a745de4592ea9319c95fd770bb3102b4b1f43e7d4a430991a35b68fe45a04f3bfc1fdb8c26d9eee64efaa4b8462d5dbca3a59ea77927f19754629839c72f82ce86813c811c5299879648843c5495358020cbbb38c50eb777b8ef042482e14ccc002e49949306247e28ddef7e9d6a1879796969a456e28dff1ef5515ed81bfb30df5c49892cee2b5695a768000000"

// Usage:
let gbh="61616161616161343030303030303061617373686873687368736a736965697268726862646a646a64687361616161616168646a646a646a646a6864626468646a65696561676761616161616161616161616161616161616161616161737373736864686568656264686568656868656161616161616161616161616161616161616161616161686568646a646a666a6a666a66687268726a6a726a726a726a726a6a726a646a726a726a6a746a666a726a646a646a6a65686576626562656a656a69736a64686468646a646a6a646a646a646a646a6a646a646a726a646a646a646a6468687268726872687268726a726a6a64696569656a736273686964756568656868656a65696569656868656a726964697269666a6a726a726a746a6b746f746b746b746b746b6a746a746a666a666a6a66666a6a666a666a6a666a666a666a666a666a6a666a666a666a646b6b646b646a6a646a646a646a68666a666a666a666a6a666a666a666a666a6a666a666a666a666a666a666a666a666a666a6a666a666a666a6161616161616161"

let gbd="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOAAAADgCAYAAAAaLWrhAAAAAXNSR0IArs4c6QAABQxJREFUeF7t08EJADAMxLBm82zeQpfwR1ngQMSzu/c4AgQSgRFg4m6UwBcQoEcgEAoIMMQ3TUCAfoBAKCDAEN80AQH6AQKhgABDfNMEBOgHCIQCAgzxTRMQoB8gEAoIMMQ3TUCAfoBAKCDAEN80AQH6AQKhgABDfNMEBOgHCIQCAgzxTRMQoB8gEAoIMMQ3TUCAfoBAKCDAEN80AQH6AQKhgABDfNMEBOgHCIQCAgzxTRMQoB8gEAoIMMQ3TUCAfoBAKCDAEN80AQH6AQKhgABDfNMEBOgHCIQCAgzxTRMQoB8gEAoIMMQ3TUCAfoBAKCDAEN80AQH6AQKhgABDfNMEBOgHCIQCAgzxTRMQoB8gEAoIMMQ3TUCAfoBAKCDAEN80AQH6AQKhgABDfNMEBOgHCIQCAgzxTRMQoB8gEAoIMMQ3TUCAfoBAKCDAEN80AQH6AQKhgABDfNMEBOgHCIQCAgzxTRMQoB8gEAoIMMQ3TUCAfoBAKCDAEN80AQH6AQKhgABDfNMEBOgHCIQCAgzxTRMQoB8gEAoIMMQ3TUCAfoBAKCDAEN80AQH6AQKhgABDfNMEBOgHCIQCAgzxTRMQoB8gEAoIMMQ3TUCAfoBAKCDAEN80AQH6AQKhgABDfNMEBOgHCIQCAgzxTRMQoB8gEAoIMMQ3TUCAfoBAKCDAEN80AQH6AQKhgABDfNMEBOgHCIQCAgzxTRMQoB8gEAoIMMQ3TUCAfoBAKCDAEN80AQH6AQKhgABDfNMEBOgHCIQCAgzxTRMQoB8gEAoIMMQ3TUCAfoBAKCDAEN80AQH6AQKhgABDfNMEBOgHCIQCAgzxTRMQoB8gEAoIMMQ3TUCAfoBAKCDAEN80AQH6AQKhgABDfNMEBOgHCIQCAgzxTRMQoB8gEAoIMMQ3TUCAfoBAKCDAEN80AQH6AQKhgABDfNMEBOgHCIQCAgzxTRMQoB8gEAoIMMQ3TUCAfoBAKCDAEN80AQH6AQKhgABDfNMEBOgHCIQCAgzxTRMQoB8gEAoIMMQ3TUCAfoBAKCDAEN80AQH6AQKhgABDfNMEBOgHCIQCAgzxTRMQoB8gEAoIMMQ3TUCAfoBAKCDAEN80AQH6AQKhgABDfNMEBOgHCIQCAgzxTRMQoB8gEAoIMMQ3TUCAfoBAKCDAEN80AQH6AQKhgABDfNMEBOgHCIQCAgzxTRMQoB8gEAoIMMQ3TUCAfoBAKCDAEN80AQH6AQKhgABDfNMEBOgHCIQCAgzxTRMQoB8gEAoIMMQ3TUCAfoBAKCDAEN80AQH6AQKhgABDfNMEBOgHCIQCAgzxTRMQoB8gEAoIMMQ3TUCAfoBAKCDAEN80AQH6AQKhgABDfNMEBOgHCIQCAgzxTRMQoB8gEAoIMMQ3TUCAfoBAKCDAEN80AQH6AQKhgABDfNMEBOgHCIQCAgzxTRMQoB8gEAoIMMQ3TUCAfoBAKCDAEN80AQH6AQKhgABDfNMEBOgHCIQCAgzxTRMQoB8gEAoIMMQ3TUCAfoBAKCDAEN80AQH6AQKhgABDfNMEBOgHCIQCAgzxTRMQoB8gEAoIMMQ3TUCAfoBAKCDAEN80AQH6AQKhgABDfNMEBOgHCIQCAgzxTRMQoB8gEAoIMMQ3TUCAfoBAKCDAEN80AQH6AQKhgABDfNMEBOgHCIQCAgzxTRMQoB8gEAoIMMQ3TUCAfoBAKCDAEN80AQH6AQKhgABDfNMEHpV3MB+19a4+AAAAAElFTkSuQmCC"
function dth(decimal) {
    return decimal.toString(16).toUpperCase().padStart(2, '0');
}

// Example usage




const url = 'wss://lcm2.krea.ai/ws?useMsgpack';

const headers = {
  'Host': 'lcm2.krea.ai',
  'Connection': 'Upgrade',
  'Pragma': 'no-cache',
  'Cache-Control': 'no-cache',
  'User-Agent': 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36',
  'Upgrade': 'websocket',
  'Origin': 'https://www.krea.ai',
  'Sec-WebSocket-Version': '13',
  'Accept-Encoding': 'gzip, deflate, br',
  'Accept-Language': 'en-MY,en;q=0.9,ms-MY;q=0.8,ms;q=0.7,en-GB;q=0.6,en-US;q=0.5',
  'Sec-WebSocket-Key': 'KklgyMR4JnqlWT65VA1wOQ==',
  'Sec-WebSocket-Extensions': 'permessage-deflate; client_max_window_bits'
};

// Create a new WebSocket connection
const ws = new WebSocket(url, null, headers);


let ds1="8ea473656564a5";
let ds2="a86d6f64656c5f6964a76b7265615f786ca670726f6d7074da019b";
let df1="2c206f626a65637420386bae67756964616e63655f7363616c6500a8737472656e67746801a5737465707305ac7374796c655f696d61676573";

let df3="b6676c6f62616c5f7374796c655f69705f776569676874cb3ff4cccccccccccdaa696d6167655f73697a65cd0576ab696d6167655f6279746573c50576524946466e05000057454250565038580a000000200000001f00001f000049434350c8010000000001c800000000043000006d6e74725247422058595a2007e00001000100000000000061637370000000000000000000000000000000000000000000000000000000010000f6d6000100000000d32d0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000964657363000000f0000000247258595a00000114000000146758595a00000128000000146258595a0000013c00000014777470740000015000000014725452430000016400000028675452430000016400000028625452430000016400000028637072740000018c0000003c6d6c756300000000000000010000000c656e5553000000080000001c007300520047004258595a200000000000006fa2000038f50000039058595a2000000000000062990000b785000018da58595a2000000000000024a000000f840000b6cf58595a20000000000000f6d6000100000000d32d706172610000000000040000000266660000f2a700000d59000013d000000a5b00000000000000006d6c756300000000000000010000000c656e5553000000200000001c0047006f006f0067006c006500200049006e0063002e0020003200300031003656503820800300003011009d012a2000200001402625b00274ca0c60f604180db01fa93bc03ce03d0efd403d003ca7ff703e003f683f6dbda9ffffe08234132b3f1990377e7de0dc01d81545bfc67849ff1fdec51d27a01fd57c01be01fe03cddffc7f627fd2ffe3ff52f305f18ff8bfed3f001fc67f99ffabfee9eccdea8bf403d8d7f54cfb6ac4b28faf2cfe1cc7ccb8f0d8b94298973e000000f8cc488f334c34bb1dad95413912f63dbb8a777395638b0ccfd7fe9f8abdd17f57825c1a8e40decd91977164546a259cd0bbca50b8f9ef12f5ea2a004443375f3a12d2f443ae7538ed25ac789766310139d7011ffaec8938b7baf4e50efcf27aa794b5730b9dbdd8a0fe4667d745a3d5dac92f2105d591aa970a43ad86eb888c992aa71862e7d2f767a3a486a717ad73e6f3cc83624766de0033227782d9673ce0d892bf9fa8d373604125b286c44831f419e1eff1f54c4dcd91f34fcf6c7900569f49c99dfdbfb4358c9b079dd93cb948b4b8cbdd38ffc39be43d2b3af12c531ffa4385f9a0cbeea3b302b2700b5fc775570e79d1fc354bd30ffe74ac3c467d970cf7e939982b0e6017c166523b948ad89b495f0fe7b53374edbd0bb846fa28750300697c76dfe79e0a50a42fc26a60dec501694f168d929e7fc90d640c6dad68a9d8c85a4808d177f7d146cf49cbd20bb017abf17912145f8e285f771ee1c5aaa9700bf1541f2d45a2069c17983f524c9d32c53265e675277a8c43a2d1b2f2f1083e0a956ffc30e745c4f54b9e082dc859545a08d59de1e5ee9e4c56058527e3fcdd31dd96109f4b6b62e40267bfdb8fb5533cea2b4a747ca35df9b9e9d7cef931f5e282b19f621545b38c57005000377c4992fa876ff4baa5288c4c4ea82cdfaddaf44d476e7f85e57b0b46dac409668ede9ed9ff7c8caa552c7cb8272c0e8743a43d200e4f306e3e43ff17f7d79c3ac41b1cbaa94d94443e7f84cb7b72c1b357787ce275e91d8c5d00a770ee54a7dd8392d3732b3d743282ecc6b33f3e9838eb713391bb4a84ee910bfe90ecc336ca856628330417ad72fbf5afae8128a745de4592ea9319c95fd770bb3102b4b1f43e7d4a430991a35b68fe45a04f3bfc1fdb8c26d9eee64efaa4b8462d5dbca3a59ea77927f19754629839c72f82ce86813c811c5299879648843c5495358020cbbb38c50eb777b8ef042482e14ccc002e49949306247e28ddef7e9d6a1879796969a456e28dff1ef5515ed81bfb30df5c49892cee2b5695a768000000";
let df2="7769647468cd0400a6686569676874cd0400ae636f6d62696e655f6d6574686f64a761766572616765b0676c6f62616c5f69705f776569676874"

let dm="90a5";
let dm1="9182a464617461da";//add length 072e
let dx1="01";
let dx2="cb3fd999999999999a";
//dx2="cb3fd999999999999a"

let dm2="a8737472656e677468cb3fd999999999999aa5";


let de="8ea473656564a6373932353338a86d6f64656c5f6964a76b7265615f786ca670726f6d7074da019b616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616162612c206f626a65637420386bae67756964616e63655f7363616c6500a8737472656e67746801a5737465707305ac7374796c655f696d6167657390a57769647468cd0400a6686569676874cd0400ae636f6d62696e655f6d6574686f64a761766572616765b0676c6f62616c5f69705f77656967687401b6676c6f62616c5f7374796c655f69705f776569676874cb3ff4cccccccccccdaa696d6167655f73697a65cd0576ab696d6167655f6279746573c50576524946466e05000057454250565038580a000000200000001f00001f000049434350c8010000000001c800000000043000006d6e74725247422058595a2007e00001000100000000000061637370000000000000000000000000000000000000000000000000000000010000f6d6000100000000d32d0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000964657363000000f0000000247258595a00000114000000146758595a00000128000000146258595a0000013c00000014777470740000015000000014725452430000016400000028675452430000016400000028625452430000016400000028637072740000018c0000003c6d6c756300000000000000010000000c656e5553000000080000001c007300520047004258595a200000000000006fa2000038f50000039058595a2000000000000062990000b785000018da58595a2000000000000024a000000f840000b6cf58595a20000000000000f6d6000100000000d32d706172610000000000040000000266660000f2a700000d59000013d000000a5b00000000000000006d6c756300000000000000010000000c656e5553000000200000001c0047006f006f0067006c006500200049006e0063002e0020003200300031003656503820800300003011009d012a2000200001402625b00274ca0c60f604180db01fa93bc03ce03d0efd403d003ca7ff703e003f683f6dbda9ffffe08234132b3f1990377e7de0dc01d81545bfc67849ff1fdec51d27a01fd57c01be01fe03cddffc7f627fd2ffe3ff52f305f18ff8bfed3f001fc67f99ffabfee9eccdea8bf403d8d7f54cfb6ac4b28faf2cfe1cc7ccb8f0d8b94298973e000000f8cc488f334c34bb1dad95413912f63dbb8a777395638b0ccfd7fe9f8abdd17f57825c1a8e40decd91977164546a259cd0bbca50b8f9ef12f5ea2a004443375f3a12d2f443ae7538ed25ac789766310139d7011ffaec8938b7baf4e50efcf27aa794b5730b9dbdd8a0fe4667d745a3d5dac92f2105d591aa970a43ad86eb888c992aa71862e7d2f767a3a486a717ad73e6f3cc83624766de0033227782d9673ce0d892bf9fa8d373604125b286c44831f419e1eff1f54c4dcd91f34fcf6c7900569f49c99dfdbfb4358c9b079dd93cb948b4b8cbdd38ffc39be43d2b3af12c531ffa4385f9a0cbeea3b302b2700b5fc775570e79d1fc354bd30ffe74ac3c467d970cf7e939982b0e6017c166523b948ad89b495f0fe7b53374edbd0bb846fa28750300697c76dfe79e0a50a42fc26a60dec501694f168d929e7fc90d640c6dad68a9d8c85a4808d177f7d146cf49cbd20bb017abf17912145f8e285f771ee1c5aaa9700bf1541f2d45a2069c17983f524c9d32c53265e675277a8c43a2d1b2f2f1083e0a956ffc30e745c4f54b9e082dc859545a08d59de1e5ee9e4c56058527e3fcdd31dd96109f4b6b62e40267bfdb8fb5533cea2b4a747ca35df9b9e9d7cef931f5e282b19f621545b38c57005000377c4992fa876ff4baa5288c4c4ea82cdfaddaf44d476e7f85e57b0b46dac409668ede9ed9ff7c8caa552c7cb8272c0e8743a43d200e4f306e3e43ff17f7d79c3ac41b1cbaa94d94443e7f84cb7b72c1b357787ce275e91d8c5d00a770ee54a7dd8392d3732b3d743282ecc6b33f3e9838eb713391bb4a84ee910bfe90ecc336ca856628330417ad72fbf5afae8128a745de4592ea9319c95fd770bb3102b4b1f43e7d4a430991a35b68fe45a04f3bfc1fdb8c26d9eee64efaa4b8462d5dbca3a59ea77927f19754629839c72f82ce86813c811c5299879648843c5495358020cbbb38c50eb777b8ef042482e14ccc002e49949306247e28ddef7e9d6a1879796969a456e28dff1ef5515ed81bfb30df5c49892cee2b5695a768000000"

// The hex string to be sent


// Convert the hex string to a binary ArrayBuffer
function hexToArrayBuffer(hex) {
    const bytes = new Uint8Array(hex.length / 2);
    for (let i = 0; i < bytes.length; i++) {
        bytes[i] = parseInt(hex.substr(i * 2, 2), 16);
    }
    return bytes.buffer;
}

// WebSocket connection


// On WebSocket open
ws.onopen = () => {
    //console.log('WebSocket connection opened');
    
    // Convert hex to ArrayBuffer and send it
    //let fp=hf+textToHex("hi")+hs;
    //fp=de;
    //const arrayBuffer = hexToArrayBuffer(fp);
    //ws.send(arrayBuffer);
};

// Handle WebSocket messages
ws.onmessage = (event) => {
    //console.log("received "+event.data)
    const b=new Blob([event.data],{type:"image/png"});
    let el=document.getElementById("myimg");
    el.src=URL.createObjectURL(b);
    if (typeof event.data === 'string') {
        console.log('Text message from server:', event.data);
    } else if (event.data instanceof ArrayBuffer) {
        console.log('Binary message from server:', new Uint8Array(event.data));
    }
};

// Handle WebSocket errors
ws.onerror = (error) => {
    console.error('WebSocket error:', error);
};

// Handle WebSocket close
ws.onclose = () => {
    console.log('WebSocket connection closed');
};


function tth(text) {
    let hexString = "";
    for (let i = 0; i < text.length; i++) {
        // Convert each character to its ASCII/Unicode code point
        let hex = text.charCodeAt(i).toString(16);
        // Ensure that each hex code is 2 characters long (padding with 0 if needed)
        hexString += hex.padStart(2, "0");
    }
    return hexString;
}
//console.log(tth((1838).toString()))

function ft(t){
    let r=400-t.length;
   // console.log("remained length is :"+r)
    let j=t;
    for(let i=0;i<r;++i){
        j+=" ";
    }
    //console.log("new length is"+j.length)
    return j;
}

let sid="24659";
let pv="";
let o="0123456789";
let gb="";

// Example usage

    let p=document.getElementById("prompt");
    let v=document.getElementById("change");
    
    
    function genimg(t,sid){
        //console.log(t)
        let h=tth(ft(t))
        sid="24659";
        let sidh=tth(sid);
        //console.log(sid)
        let ee="";
        let ls="";
        if(gb==""){
            ee=df1+dm+df2+dx1+df3;
        } else{
            let l=gb.length;
            let lh=dth(l);
            ls="";
            
            if(lh.length%2!=0)ls+="0";
            ls+=lh;
            ls=ls.toLowerCase();
            console.log(ls)
            ee=df1+dm1+ls+tth(gb)+dm2+df2+dx2+df3
            console.log(gb)
        }
       // copyToClipboard(gb)
        //console.log(ls)
        let fp=ds1+sidh+ds2+h+ee;
       // fp=ds1+sidh+ds2+h+df1+dm1+ls+tth(gbd)+dm2+df2+dx2+df3;
        //fp=uu
      // console.log(sidh)
        if (ws && ws.readyState === WebSocket.OPEN) {
        const arrayBuffer = hexToArrayBuffer(fp);
    ws.send(arrayBuffer);
        //console.log('Data sent to WebSocket server');
       // console.log(ft(pv).length)
    }
    }
    v.onclick=e=>{
        sid="";
        for (let i=0;i<6;++i){
            sid+=o[Math.floor(Math.random()*10)];
        }
        genimg(pv,sid);
    }
    
    p.oninput = e =>{ 
        
        pv=e.target.value;
        genimg(pv,sid);
        /*console.log(pv)
        let h=tth(ft(pv))
        let sidh=tth(sid);
        console.log(sid)
        let fp=ds1+sidh+ds2+h+df;
        if (ws && ws.readyState === WebSocket.OPEN) {
        const arrayBuffer = hexToArrayBuffer(fp);
    ws.send(arrayBuffer);
        //console.log('Data sent to WebSocket server');
       // console.log(ft(pv).length)
    }*/
    }
    
    
    document.getElementById('fileInput').addEventListener('change', function(event) {
    const file = event.target.files[0];
    if (file) {
        const reader = new FileReader();
        
        reader.onload = function(e) {
            // Display the image
            const imagePreview = document.getElementById('imagePreview');
            imagePreview.src = e.target.result;
            imagePreview.style.display = 'block';

            // Display the base64 data
            //const imageData = document.getElementById('imageData');
            //imageData.value = e.target.result;
            gb=e.target.result;
        };

        reader.readAsDataURL(file);
    }
});



document.getElementById('fetchImage').addEventListener('click', async function() {
            gb="";
            const url = document.getElementById('imageUrl').value;
            if (!url) {
                alert('Please enter an image URL');
                return;
            }

            try {
                // Fetch the image
                const response = await fetch(url);
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }

                // Convert the response to a Blob
                const blob = await response.blob();
                const reader = new FileReader();

                reader.onloadend = function() {
                    // Display the image
                    const imagePreview = document.getElementById('imagePreview');
                    imagePreview.src = reader.result;
                    imagePreview.style.display = 'block';

                    // Display the base64 data URL
                    //const imageData = document.getElementById('imageData');
                    //imageData.value = reader.result;
                    //console.log(reader.result)
                    gb=reader.result;
                };

                // Read the Blob as a data URL
                reader.readAsDataURL(blob);
                console.log(blob)
            } catch (error) {
                console.error('Error fetching image:', error);
                alert('Failed to fetch image. Check the URL and try again.');
            }
        });
    
}



    </script>
</html>



